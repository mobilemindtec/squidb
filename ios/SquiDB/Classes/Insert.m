//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: ./build/j2objc/java/Insert.java
//

#include "CompileContext.h"
#include "IOSObjectArray.h"
#include "Insert.h"
#include "J2ObjC_source.h"
#include "Property.h"
#include "Query.h"
#include "SqlBuilder.h"
#include "SqlTable.h"
#include "SquidUtilities.h"
#include "Table.h"
#include "TableStatement.h"
#include "ValuesStorage.h"
#include "VersionCode.h"
#include "View.h"
#include "java/lang/IllegalStateException.h"
#include "java/lang/StringBuilder.h"
#include "java/lang/UnsupportedOperationException.h"
#include "java/util/ArrayList.h"
#include "java/util/Arrays.h"
#include "java/util/List.h"
#include "java/util/Map.h"
#include "java/util/Set.h"

@interface SquiDBInsert () {
 @public
  SquiDBSqlTable *table_;
  SquiDBTableStatement_ConflictAlgorithm *conflictAlgorithm_;
  id<JavaUtilList> columns_;
  id<JavaUtilList> valuesToInsert_;
  SquiDBQuery *query_;
  jboolean defaultValues_;
}

- (instancetype)initWithSquiDBSqlTable:(SquiDBSqlTable *)table;

- (void)assertValues;

- (void)assertValueSetSizesWithInt:(jint)size;

- (void)visitConflictAlgorithmWithJavaLangStringBuilder:(JavaLangStringBuilder *)sql;

- (void)visitColumnsWithJavaLangStringBuilder:(JavaLangStringBuilder *)sql;

- (void)visitQueryWithSquiDBSqlBuilder:(SquiDBSqlBuilder *)builder
                           withBoolean:(jboolean)forSqlValidation;

- (void)visitValuesWithSquiDBSqlBuilder:(SquiDBSqlBuilder *)builder
                            withBoolean:(jboolean)forSqlValidation;

@end

J2OBJC_FIELD_SETTER(SquiDBInsert, table_, SquiDBSqlTable *)
J2OBJC_FIELD_SETTER(SquiDBInsert, conflictAlgorithm_, SquiDBTableStatement_ConflictAlgorithm *)
J2OBJC_FIELD_SETTER(SquiDBInsert, columns_, id<JavaUtilList>)
J2OBJC_FIELD_SETTER(SquiDBInsert, valuesToInsert_, id<JavaUtilList>)
J2OBJC_FIELD_SETTER(SquiDBInsert, query_, SquiDBQuery *)

__attribute__((unused)) static void SquiDBInsert_initWithSquiDBSqlTable_(SquiDBInsert *self, SquiDBSqlTable *table);

__attribute__((unused)) static SquiDBInsert *new_SquiDBInsert_initWithSquiDBSqlTable_(SquiDBSqlTable *table) NS_RETURNS_RETAINED;

__attribute__((unused)) static SquiDBInsert *create_SquiDBInsert_initWithSquiDBSqlTable_(SquiDBSqlTable *table);

__attribute__((unused)) static void SquiDBInsert_assertValues(SquiDBInsert *self);

__attribute__((unused)) static void SquiDBInsert_assertValueSetSizesWithInt_(SquiDBInsert *self, jint size);

__attribute__((unused)) static void SquiDBInsert_visitConflictAlgorithmWithJavaLangStringBuilder_(SquiDBInsert *self, JavaLangStringBuilder *sql);

__attribute__((unused)) static void SquiDBInsert_visitColumnsWithJavaLangStringBuilder_(SquiDBInsert *self, JavaLangStringBuilder *sql);

__attribute__((unused)) static void SquiDBInsert_visitQueryWithSquiDBSqlBuilder_withBoolean_(SquiDBInsert *self, SquiDBSqlBuilder *builder, jboolean forSqlValidation);

__attribute__((unused)) static void SquiDBInsert_visitValuesWithSquiDBSqlBuilder_withBoolean_(SquiDBInsert *self, SquiDBSqlBuilder *builder, jboolean forSqlValidation);

J2OBJC_INITIALIZED_DEFN(SquiDBInsert)

SquiDBVersionCode *SquiDBInsert_SQLITE_VERSION_MULTI_ROW_INSERT;

@implementation SquiDBInsert

+ (SquiDBVersionCode *)SQLITE_VERSION_MULTI_ROW_INSERT {
  return SquiDBInsert_SQLITE_VERSION_MULTI_ROW_INSERT;
}

- (instancetype)initWithSquiDBSqlTable:(SquiDBSqlTable *)table {
  SquiDBInsert_initWithSquiDBSqlTable_(self, table);
  return self;
}

+ (SquiDBInsert *)intoWithSquiDBTable:(SquiDBTable *)table {
  return SquiDBInsert_intoWithSquiDBTable_(table);
}

+ (SquiDBInsert *)intoWithSquiDBView:(SquiDBView *)view {
  return SquiDBInsert_intoWithSquiDBView_(view);
}

- (SquiDBSqlTable *)getTable {
  return table_;
}

- (SquiDBInsert *)columnsWithSquiDBPropertyArray:(IOSObjectArray *)columns {
  {
    IOSObjectArray *a__ = columns;
    SquiDBProperty * const *b__ = ((IOSObjectArray *) nil_chk(a__))->buffer_;
    SquiDBProperty * const *e__ = b__ + a__->size_;
    while (b__ < e__) {
      SquiDBProperty *column = *b__++;
      [((id<JavaUtilList>) nil_chk(self->columns_)) addWithId:[((SquiDBProperty *) nil_chk(column)) getExpression]];
    }
  }
  defaultValues_ = false;
  [self invalidateCompileCache];
  return self;
}

- (SquiDBInsert *)columnsWithNSStringArray:(IOSObjectArray *)columnNames {
  SquiDBSquidUtilities_addAllWithJavaUtilCollection_withNSObjectArray_(self->columns_, columnNames);
  defaultValues_ = false;
  [self invalidateCompileCache];
  return self;
}

- (SquiDBInsert *)valuesWithNSObjectArray:(IOSObjectArray *)values {
  [((id<JavaUtilList>) nil_chk(valuesToInsert_)) addWithId:JavaUtilArrays_asListWithNSObjectArray_(values)];
  query_ = nil;
  defaultValues_ = false;
  [self invalidateCompileCache];
  return self;
}

- (SquiDBInsert *)selectWithSquiDBQuery:(SquiDBQuery *)select {
  self->query_ = select;
  [((id<JavaUtilList>) nil_chk(valuesToInsert_)) clear];
  defaultValues_ = false;
  [self invalidateCompileCache];
  return self;
}

- (SquiDBInsert *)fromValuesWithSquiDBValuesStorage:(SquiDBValuesStorage *)values {
  id<JavaUtilList> valuesToInsert = new_JavaUtilArrayList_init();
  for (id<JavaUtilMap_Entry> __strong entry_ in nil_chk([((SquiDBValuesStorage *) nil_chk(values)) valueSet])) {
    [((id<JavaUtilList>) nil_chk(self->columns_)) addWithId:[((id<JavaUtilMap_Entry>) nil_chk(entry_)) getKey]];
    [valuesToInsert addWithId:[entry_ getValue]];
  }
  [((id<JavaUtilList>) nil_chk(self->valuesToInsert_)) addWithId:valuesToInsert];
  [self invalidateCompileCache];
  return self;
}

- (SquiDBInsert *)defaultValues {
  defaultValues_ = true;
  [((id<JavaUtilList>) nil_chk(columns_)) clear];
  [((id<JavaUtilList>) nil_chk(valuesToInsert_)) clear];
  query_ = nil;
  [self invalidateCompileCache];
  return self;
}

- (jint)getNumRows {
  return [((id<JavaUtilList>) nil_chk(valuesToInsert_)) size];
}

- (SquiDBInsert *)onConflictWithSquiDBTableStatement_ConflictAlgorithm:(SquiDBTableStatement_ConflictAlgorithm *)conflictAlgorithm {
  self->conflictAlgorithm_ = conflictAlgorithm;
  [self invalidateCompileCache];
  return self;
}

- (void)appendToSqlBuilderWithSquiDBSqlBuilder:(SquiDBSqlBuilder *)builder
                                   withBoolean:(jboolean)forSqlValidation {
  SquiDBInsert_assertValues(self);
  (void) [((JavaLangStringBuilder *) nil_chk(((SquiDBSqlBuilder *) nil_chk(builder))->sql_)) appendWithNSString:@"INSERT "];
  SquiDBInsert_visitConflictAlgorithmWithJavaLangStringBuilder_(self, builder->sql_);
  (void) [((JavaLangStringBuilder *) nil_chk([((JavaLangStringBuilder *) nil_chk([builder->sql_ appendWithNSString:@"INTO "])) appendWithNSString:[((SquiDBSqlTable *) nil_chk(table_)) getExpression]])) appendWithNSString:@" "];
  SquiDBInsert_visitColumnsWithJavaLangStringBuilder_(self, builder->sql_);
  if (![((id<JavaUtilList>) nil_chk(valuesToInsert_)) isEmpty]) {
    SquiDBInsert_visitValuesWithSquiDBSqlBuilder_withBoolean_(self, builder, forSqlValidation);
  }
  else if (query_ != nil) {
    SquiDBInsert_visitQueryWithSquiDBSqlBuilder_withBoolean_(self, builder, forSqlValidation);
  }
  else {
    (void) [builder->sql_ appendWithNSString:@"DEFAULT VALUES"];
  }
}

- (void)assertValues {
  SquiDBInsert_assertValues(self);
}

- (void)assertValueSetSizesWithInt:(jint)size {
  SquiDBInsert_assertValueSetSizesWithInt_(self, size);
}

- (void)visitConflictAlgorithmWithJavaLangStringBuilder:(JavaLangStringBuilder *)sql {
  SquiDBInsert_visitConflictAlgorithmWithJavaLangStringBuilder_(self, sql);
}

- (void)visitColumnsWithJavaLangStringBuilder:(JavaLangStringBuilder *)sql {
  SquiDBInsert_visitColumnsWithJavaLangStringBuilder_(self, sql);
}

- (void)visitQueryWithSquiDBSqlBuilder:(SquiDBSqlBuilder *)builder
                           withBoolean:(jboolean)forSqlValidation {
  SquiDBInsert_visitQueryWithSquiDBSqlBuilder_withBoolean_(self, builder, forSqlValidation);
}

- (void)visitValuesWithSquiDBSqlBuilder:(SquiDBSqlBuilder *)builder
                            withBoolean:(jboolean)forSqlValidation {
  SquiDBInsert_visitValuesWithSquiDBSqlBuilder_withBoolean_(self, builder, forSqlValidation);
}

+ (const J2ObjcClassInfo *)__metadata {
  static J2ObjcMethodInfo methods[] = {
    { NULL, NULL, 0x2, -1, 0, -1, 1, -1, -1 },
    { NULL, "LSquiDBInsert;", 0x9, 2, 3, -1, -1, -1, -1 },
    { NULL, "LSquiDBInsert;", 0x9, 2, 4, -1, -1, -1, -1 },
    { NULL, "LSquiDBSqlTable;", 0x1, -1, -1, -1, 5, -1, -1 },
    { NULL, "LSquiDBInsert;", 0x81, 6, 7, -1, 8, -1, -1 },
    { NULL, "LSquiDBInsert;", 0x81, 6, 9, -1, -1, -1, -1 },
    { NULL, "LSquiDBInsert;", 0x81, 10, 11, -1, -1, -1, -1 },
    { NULL, "LSquiDBInsert;", 0x1, 12, 13, -1, -1, -1, -1 },
    { NULL, "LSquiDBInsert;", 0x1, 14, 15, -1, -1, -1, -1 },
    { NULL, "LSquiDBInsert;", 0x1, -1, -1, -1, -1, -1, -1 },
    { NULL, "I", 0x1, -1, -1, -1, -1, -1, -1 },
    { NULL, "LSquiDBInsert;", 0x1, 16, 17, -1, -1, -1, -1 },
    { NULL, "V", 0x0, 18, 19, -1, -1, -1, -1 },
    { NULL, "V", 0x2, -1, -1, -1, -1, -1, -1 },
    { NULL, "V", 0x2, 20, 21, -1, -1, -1, -1 },
    { NULL, "V", 0x2, 22, 23, -1, -1, -1, -1 },
    { NULL, "V", 0x2, 24, 23, -1, -1, -1, -1 },
    { NULL, "V", 0x2, 25, 19, -1, -1, -1, -1 },
    { NULL, "V", 0x2, 26, 19, -1, -1, -1, -1 },
  };
  #pragma clang diagnostic push
  #pragma clang diagnostic ignored "-Wobjc-multiple-method-names"
  #pragma clang diagnostic ignored "-Wundeclared-selector"
  methods[0].selector = @selector(initWithSquiDBSqlTable:);
  methods[1].selector = @selector(intoWithSquiDBTable:);
  methods[2].selector = @selector(intoWithSquiDBView:);
  methods[3].selector = @selector(getTable);
  methods[4].selector = @selector(columnsWithSquiDBPropertyArray:);
  methods[5].selector = @selector(columnsWithNSStringArray:);
  methods[6].selector = @selector(valuesWithNSObjectArray:);
  methods[7].selector = @selector(selectWithSquiDBQuery:);
  methods[8].selector = @selector(fromValuesWithSquiDBValuesStorage:);
  methods[9].selector = @selector(defaultValues);
  methods[10].selector = @selector(getNumRows);
  methods[11].selector = @selector(onConflictWithSquiDBTableStatement_ConflictAlgorithm:);
  methods[12].selector = @selector(appendToSqlBuilderWithSquiDBSqlBuilder:withBoolean:);
  methods[13].selector = @selector(assertValues);
  methods[14].selector = @selector(assertValueSetSizesWithInt:);
  methods[15].selector = @selector(visitConflictAlgorithmWithJavaLangStringBuilder:);
  methods[16].selector = @selector(visitColumnsWithJavaLangStringBuilder:);
  methods[17].selector = @selector(visitQueryWithSquiDBSqlBuilder:withBoolean:);
  methods[18].selector = @selector(visitValuesWithSquiDBSqlBuilder:withBoolean:);
  #pragma clang diagnostic pop
  static const J2ObjcFieldInfo fields[] = {
    { "SQLITE_VERSION_MULTI_ROW_INSERT", "LSquiDBVersionCode;", .constantValue.asLong = 0, 0x19, -1, 27, -1, -1 },
    { "table_", "LSquiDBSqlTable;", .constantValue.asLong = 0, 0x12, -1, -1, 28, -1 },
    { "conflictAlgorithm_", "LSquiDBTableStatement_ConflictAlgorithm;", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
    { "columns_", "LJavaUtilList;", .constantValue.asLong = 0, 0x12, -1, -1, 29, -1 },
    { "valuesToInsert_", "LJavaUtilList;", .constantValue.asLong = 0, 0x12, -1, -1, 30, -1 },
    { "query_", "LSquiDBQuery;", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
    { "defaultValues_", "Z", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
  };
  static const void *ptrTable[] = { "LSquiDBSqlTable;", "(Lcom/yahoo/squidb/sql/SqlTable<*>;)V", "into", "LSquiDBTable;", "LSquiDBView;", "()Lcom/yahoo/squidb/sql/SqlTable<*>;", "columns", "[LSquiDBProperty;", "([Lcom/yahoo/squidb/sql/Property<*>;)Lcom/yahoo/squidb/sql/Insert;", "[LNSString;", "values", "[LNSObject;", "select", "LSquiDBQuery;", "fromValues", "LSquiDBValuesStorage;", "onConflict", "LSquiDBTableStatement_ConflictAlgorithm;", "appendToSqlBuilder", "LSquiDBSqlBuilder;Z", "assertValueSetSizes", "I", "visitConflictAlgorithm", "LJavaLangStringBuilder;", "visitColumns", "visitQuery", "visitValues", &SquiDBInsert_SQLITE_VERSION_MULTI_ROW_INSERT, "Lcom/yahoo/squidb/sql/SqlTable<*>;", "Ljava/util/List<Ljava/lang/String;>;", "Ljava/util/List<Ljava/util/List<Ljava/lang/Object;>;>;" };
  static const J2ObjcClassInfo _SquiDBInsert = { "Insert", "com.yahoo.squidb.sql", ptrTable, methods, fields, 7, 0x1, 19, 7, -1, -1, -1, -1, -1 };
  return &_SquiDBInsert;
}

+ (void)initialize {
  if (self == [SquiDBInsert class]) {
    SquiDBInsert_SQLITE_VERSION_MULTI_ROW_INSERT = new_SquiDBVersionCode_initWithInt_withInt_withInt_withInt_(3, 7, 11, 0);
    J2OBJC_SET_INITIALIZED(SquiDBInsert)
  }
}

@end

void SquiDBInsert_initWithSquiDBSqlTable_(SquiDBInsert *self, SquiDBSqlTable *table) {
  SquiDBTableStatement_init(self);
  self->conflictAlgorithm_ = JreLoadEnum(SquiDBTableStatement_ConflictAlgorithm, NONE);
  self->columns_ = new_JavaUtilArrayList_init();
  self->valuesToInsert_ = new_JavaUtilArrayList_init();
  self->table_ = table;
}

SquiDBInsert *new_SquiDBInsert_initWithSquiDBSqlTable_(SquiDBSqlTable *table) {
  J2OBJC_NEW_IMPL(SquiDBInsert, initWithSquiDBSqlTable_, table)
}

SquiDBInsert *create_SquiDBInsert_initWithSquiDBSqlTable_(SquiDBSqlTable *table) {
  J2OBJC_CREATE_IMPL(SquiDBInsert, initWithSquiDBSqlTable_, table)
}

SquiDBInsert *SquiDBInsert_intoWithSquiDBTable_(SquiDBTable *table) {
  SquiDBInsert_initialize();
  return new_SquiDBInsert_initWithSquiDBSqlTable_(table);
}

SquiDBInsert *SquiDBInsert_intoWithSquiDBView_(SquiDBView *view) {
  SquiDBInsert_initialize();
  return new_SquiDBInsert_initWithSquiDBSqlTable_(view);
}

void SquiDBInsert_assertValues(SquiDBInsert *self) {
  if (![((id<JavaUtilList>) nil_chk(self->valuesToInsert_)) isEmpty]) {
    if ([((id<JavaUtilList>) nil_chk(self->columns_)) isEmpty]) {
      @throw new_JavaLangIllegalStateException_initWithNSString_(@"No columns were specified to insert into.");
    }
    SquiDBInsert_assertValueSetSizesWithInt_(self, [self->columns_ size]);
  }
  else if (self->query_ != nil) {
    if ([((id<JavaUtilList>) nil_chk(self->columns_)) size] != [((id<JavaUtilList>) nil_chk([((SquiDBQuery *) nil_chk(self->query_)) getFields])) size]) {
      @throw new_JavaLangIllegalStateException_initWithNSString_(@"Number of properties being selected must match the number of columns specified.");
    }
  }
  else if (!self->defaultValues_) {
    @throw new_JavaLangIllegalStateException_initWithNSString_(@"No values to insert were specified.");
  }
}

void SquiDBInsert_assertValueSetSizesWithInt_(SquiDBInsert *self, jint size) {
  for (id<JavaUtilList> __strong valueSet in nil_chk(self->valuesToInsert_)) {
    if ([((id<JavaUtilList>) nil_chk(valueSet)) size] != size) {
      @throw new_JavaLangIllegalStateException_initWithNSString_(@"Number of terms in each values set must match the number of columns specified.");
    }
  }
}

void SquiDBInsert_visitConflictAlgorithmWithJavaLangStringBuilder_(SquiDBInsert *self, JavaLangStringBuilder *sql) {
  if (JreLoadEnum(SquiDBTableStatement_ConflictAlgorithm, NONE) != self->conflictAlgorithm_) {
    (void) [((JavaLangStringBuilder *) nil_chk([((JavaLangStringBuilder *) nil_chk([((JavaLangStringBuilder *) nil_chk(sql)) appendWithNSString:@"OR "])) appendWithId:self->conflictAlgorithm_])) appendWithNSString:@" "];
  }
}

void SquiDBInsert_visitColumnsWithJavaLangStringBuilder_(SquiDBInsert *self, JavaLangStringBuilder *sql) {
  if ([((id<JavaUtilList>) nil_chk(self->columns_)) isEmpty]) {
    return;
  }
  (void) [((JavaLangStringBuilder *) nil_chk(sql)) appendWithNSString:@"("];
  for (NSString * __strong column in self->columns_) {
    (void) [((JavaLangStringBuilder *) nil_chk([sql appendWithNSString:column])) appendWithNSString:@","];
  }
  (void) [sql deleteCharAtWithInt:[sql java_length] - 1];
  (void) [sql appendWithNSString:@") "];
}

void SquiDBInsert_visitQueryWithSquiDBSqlBuilder_withBoolean_(SquiDBInsert *self, SquiDBSqlBuilder *builder, jboolean forSqlValidation) {
  [((SquiDBQuery *) nil_chk(self->query_)) appendToSqlBuilderWithSquiDBSqlBuilder:builder withBoolean:forSqlValidation];
}

void SquiDBInsert_visitValuesWithSquiDBSqlBuilder_withBoolean_(SquiDBInsert *self, SquiDBSqlBuilder *builder, jboolean forSqlValidation) {
  if ([((SquiDBVersionCode *) nil_chk([((SquiDBCompileContext *) nil_chk(((SquiDBSqlBuilder *) nil_chk(builder))->compileContext_)) getVersionCode])) isLessThanWithSquiDBVersionCode:SquiDBInsert_SQLITE_VERSION_MULTI_ROW_INSERT] && [((id<JavaUtilList>) nil_chk(self->valuesToInsert_)) size] > 1) {
    @throw new_JavaLangUnsupportedOperationException_initWithNSString_(@"Can't insert with multiple sets of values below SQLite version 3.7.11");
  }
  (void) [((JavaLangStringBuilder *) nil_chk(builder->sql_)) appendWithNSString:@"VALUES "];
  for (id<JavaUtilList> __strong valuesList in nil_chk(self->valuesToInsert_)) {
    if ([((id<JavaUtilList>) nil_chk(valuesList)) isEmpty]) {
      continue;
    }
    (void) [builder->sql_ appendWithNSString:@"("];
    for (id __strong value in valuesList) {
      [builder addValueToSqlWithId:value withBoolean:forSqlValidation];
      (void) [builder->sql_ appendWithNSString:@","];
    }
    (void) [builder->sql_ deleteCharAtWithInt:[builder->sql_ java_length] - 1];
    (void) [builder->sql_ appendWithNSString:@"),"];
  }
  (void) [builder->sql_ deleteCharAtWithInt:[builder->sql_ java_length] - 1];
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(SquiDBInsert)

J2OBJC_NAME_MAPPING(SquiDBInsert, "com.yahoo.squidb.sql", "SquiDB")
