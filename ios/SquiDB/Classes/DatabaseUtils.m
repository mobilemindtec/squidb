//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: ./build/j2objc/java/DatabaseUtils.java
//

#include "CursorWindow.h"
#include "DatabaseUtils.h"
#include "ICursor.h"
#include "IOSObjectArray.h"
#include "IOSPrimitiveArray.h"
#include "J2ObjC_source.h"
#include "SQLiteDatabase.h"
#include "SQLiteProgram.h"
#include "SQLiteStatement.h"
#include "java/lang/Boolean.h"
#include "java/lang/Byte.h"
#include "java/lang/Double.h"
#include "java/lang/Float.h"
#include "java/lang/Integer.h"
#include "java/lang/Long.h"
#include "java/lang/Math.h"
#include "java/lang/Short.h"
#include "java/lang/StringBuilder.h"
#include "java/util/Locale.h"

@implementation SquiDBDatabaseUtils

+ (jint)STATEMENT_SELECT {
  return SquiDBDatabaseUtils_STATEMENT_SELECT;
}

+ (jint)STATEMENT_UPDATE {
  return SquiDBDatabaseUtils_STATEMENT_UPDATE;
}

+ (jint)STATEMENT_ATTACH {
  return SquiDBDatabaseUtils_STATEMENT_ATTACH;
}

+ (jint)STATEMENT_BEGIN {
  return SquiDBDatabaseUtils_STATEMENT_BEGIN;
}

+ (jint)STATEMENT_COMMIT {
  return SquiDBDatabaseUtils_STATEMENT_COMMIT;
}

+ (jint)STATEMENT_ABORT {
  return SquiDBDatabaseUtils_STATEMENT_ABORT;
}

+ (jint)STATEMENT_PRAGMA {
  return SquiDBDatabaseUtils_STATEMENT_PRAGMA;
}

+ (jint)STATEMENT_DDL {
  return SquiDBDatabaseUtils_STATEMENT_DDL;
}

+ (jint)STATEMENT_UNPREPARED {
  return SquiDBDatabaseUtils_STATEMENT_UNPREPARED;
}

+ (jint)STATEMENT_OTHER {
  return SquiDBDatabaseUtils_STATEMENT_OTHER;
}

J2OBJC_IGNORE_DESIGNATED_BEGIN
- (instancetype)init {
  SquiDBDatabaseUtils_init(self);
  return self;
}
J2OBJC_IGNORE_DESIGNATED_END

+ (jint)getSqlStatementTypeWithNSString:(NSString *)sql {
  return SquiDBDatabaseUtils_getSqlStatementTypeWithNSString_(sql);
}

+ (jint)getTypeOfObjectWithId:(id)obj {
  return SquiDBDatabaseUtils_getTypeOfObjectWithId_(obj);
}

+ (jint)findRowIdColumnIndexWithNSStringArray:(IOSObjectArray *)columnNames {
  return SquiDBDatabaseUtils_findRowIdColumnIndexWithNSStringArray_(columnNames);
}

+ (jint)cursorPickFillWindowStartPositionWithInt:(jint)cursorPosition
                                         withInt:(jint)cursorWindowCapacity {
  return SquiDBDatabaseUtils_cursorPickFillWindowStartPositionWithInt_withInt_(cursorPosition, cursorWindowCapacity);
}

+ (void)appendEscapedSQLStringWithJavaLangStringBuilder:(JavaLangStringBuilder *)sb
                                           withNSString:(NSString *)sqlString {
  SquiDBDatabaseUtils_appendEscapedSQLStringWithJavaLangStringBuilder_withNSString_(sb, sqlString);
}

+ (jlong)longForQueryWithSquiDBSQLiteDatabase:(SquiDBSQLiteDatabase *)db
                                 withNSString:(NSString *)query
                            withNSStringArray:(IOSObjectArray *)selectionArgs {
  return SquiDBDatabaseUtils_longForQueryWithSquiDBSQLiteDatabase_withNSString_withNSStringArray_(db, query, selectionArgs);
}

+ (jlong)longForQueryWithSquiDBSQLiteStatement:(SquiDBSQLiteStatement *)prog
                             withNSStringArray:(IOSObjectArray *)selectionArgs {
  return SquiDBDatabaseUtils_longForQueryWithSquiDBSQLiteStatement_withNSStringArray_(prog, selectionArgs);
}

+ (void)cursorFillWindowWithSquiDBICursor:(id<SquiDBICursor>)cursor
                                  withInt:(jint)position
                   withSquiDBCursorWindow:(SquiDBCursorWindow *)window {
  SquiDBDatabaseUtils_cursorFillWindowWithSquiDBICursor_withInt_withSquiDBCursorWindow_(cursor, position, window);
}

+ (void)bindObjectToProgramWithSquiDBSQLiteProgram:(SquiDBSQLiteProgram *)prog
                                           withInt:(jint)index
                                            withId:(id)value {
  SquiDBDatabaseUtils_bindObjectToProgramWithSquiDBSQLiteProgram_withInt_withId_(prog, index, value);
}

+ (const J2ObjcClassInfo *)__metadata {
  static J2ObjcMethodInfo methods[] = {
    { NULL, NULL, 0x1, -1, -1, -1, -1, -1, -1 },
    { NULL, "I", 0x9, 0, 1, -1, -1, -1, -1 },
    { NULL, "I", 0x9, 2, 3, -1, -1, -1, -1 },
    { NULL, "I", 0x9, 4, 5, -1, -1, -1, -1 },
    { NULL, "I", 0x9, 6, 7, -1, -1, -1, -1 },
    { NULL, "V", 0x9, 8, 9, -1, -1, -1, -1 },
    { NULL, "J", 0x9, 10, 11, -1, -1, -1, -1 },
    { NULL, "J", 0x9, 10, 12, -1, -1, -1, -1 },
    { NULL, "V", 0x9, 13, 14, -1, -1, -1, -1 },
    { NULL, "V", 0x9, 15, 16, -1, -1, -1, -1 },
  };
  #pragma clang diagnostic push
  #pragma clang diagnostic ignored "-Wobjc-multiple-method-names"
  #pragma clang diagnostic ignored "-Wundeclared-selector"
  methods[0].selector = @selector(init);
  methods[1].selector = @selector(getSqlStatementTypeWithNSString:);
  methods[2].selector = @selector(getTypeOfObjectWithId:);
  methods[3].selector = @selector(findRowIdColumnIndexWithNSStringArray:);
  methods[4].selector = @selector(cursorPickFillWindowStartPositionWithInt:withInt:);
  methods[5].selector = @selector(appendEscapedSQLStringWithJavaLangStringBuilder:withNSString:);
  methods[6].selector = @selector(longForQueryWithSquiDBSQLiteDatabase:withNSString:withNSStringArray:);
  methods[7].selector = @selector(longForQueryWithSquiDBSQLiteStatement:withNSStringArray:);
  methods[8].selector = @selector(cursorFillWindowWithSquiDBICursor:withInt:withSquiDBCursorWindow:);
  methods[9].selector = @selector(bindObjectToProgramWithSquiDBSQLiteProgram:withInt:withId:);
  #pragma clang diagnostic pop
  static const J2ObjcFieldInfo fields[] = {
    { "STATEMENT_SELECT", "I", .constantValue.asInt = SquiDBDatabaseUtils_STATEMENT_SELECT, 0x19, -1, -1, -1, -1 },
    { "STATEMENT_UPDATE", "I", .constantValue.asInt = SquiDBDatabaseUtils_STATEMENT_UPDATE, 0x19, -1, -1, -1, -1 },
    { "STATEMENT_ATTACH", "I", .constantValue.asInt = SquiDBDatabaseUtils_STATEMENT_ATTACH, 0x19, -1, -1, -1, -1 },
    { "STATEMENT_BEGIN", "I", .constantValue.asInt = SquiDBDatabaseUtils_STATEMENT_BEGIN, 0x19, -1, -1, -1, -1 },
    { "STATEMENT_COMMIT", "I", .constantValue.asInt = SquiDBDatabaseUtils_STATEMENT_COMMIT, 0x19, -1, -1, -1, -1 },
    { "STATEMENT_ABORT", "I", .constantValue.asInt = SquiDBDatabaseUtils_STATEMENT_ABORT, 0x19, -1, -1, -1, -1 },
    { "STATEMENT_PRAGMA", "I", .constantValue.asInt = SquiDBDatabaseUtils_STATEMENT_PRAGMA, 0x19, -1, -1, -1, -1 },
    { "STATEMENT_DDL", "I", .constantValue.asInt = SquiDBDatabaseUtils_STATEMENT_DDL, 0x19, -1, -1, -1, -1 },
    { "STATEMENT_UNPREPARED", "I", .constantValue.asInt = SquiDBDatabaseUtils_STATEMENT_UNPREPARED, 0x19, -1, -1, -1, -1 },
    { "STATEMENT_OTHER", "I", .constantValue.asInt = SquiDBDatabaseUtils_STATEMENT_OTHER, 0x19, -1, -1, -1, -1 },
  };
  static const void *ptrTable[] = { "getSqlStatementType", "LNSString;", "getTypeOfObject", "LNSObject;", "findRowIdColumnIndex", "[LNSString;", "cursorPickFillWindowStartPosition", "II", "appendEscapedSQLString", "LJavaLangStringBuilder;LNSString;", "longForQuery", "LSquiDBSQLiteDatabase;LNSString;[LNSString;", "LSquiDBSQLiteStatement;[LNSString;", "cursorFillWindow", "LSquiDBICursor;ILSquiDBCursorWindow;", "bindObjectToProgram", "LSquiDBSQLiteProgram;ILNSObject;" };
  static const J2ObjcClassInfo _SquiDBDatabaseUtils = { "DatabaseUtils", "com.yahoo.android.sqlite", ptrTable, methods, fields, 7, 0x1, 10, 10, -1, -1, -1, -1, -1 };
  return &_SquiDBDatabaseUtils;
}

@end

void SquiDBDatabaseUtils_init(SquiDBDatabaseUtils *self) {
  NSObject_init(self);
}

SquiDBDatabaseUtils *new_SquiDBDatabaseUtils_init() {
  J2OBJC_NEW_IMPL(SquiDBDatabaseUtils, init)
}

SquiDBDatabaseUtils *create_SquiDBDatabaseUtils_init() {
  J2OBJC_CREATE_IMPL(SquiDBDatabaseUtils, init)
}

jint SquiDBDatabaseUtils_getSqlStatementTypeWithNSString_(NSString *sql) {
  SquiDBDatabaseUtils_initialize();
  sql = [((NSString *) nil_chk(sql)) java_trim];
  if ([((NSString *) nil_chk(sql)) java_length] < 3) {
    return SquiDBDatabaseUtils_STATEMENT_OTHER;
  }
  NSString *prefixSql = [((NSString *) nil_chk([sql java_substring:0 endIndex:3])) java_uppercaseStringWithJRELocale:JreLoadStatic(JavaUtilLocale, ROOT)];
  if ([((NSString *) nil_chk(prefixSql)) isEqual:@"SEL"]) {
    return SquiDBDatabaseUtils_STATEMENT_SELECT;
  }
  else if ([prefixSql isEqual:@"INS"] || [prefixSql isEqual:@"UPD"] || [prefixSql isEqual:@"REP"] || [prefixSql isEqual:@"DEL"]) {
    return SquiDBDatabaseUtils_STATEMENT_UPDATE;
  }
  else if ([prefixSql isEqual:@"ATT"]) {
    return SquiDBDatabaseUtils_STATEMENT_ATTACH;
  }
  else if ([prefixSql isEqual:@"COM"]) {
    return SquiDBDatabaseUtils_STATEMENT_COMMIT;
  }
  else if ([prefixSql isEqual:@"END"]) {
    return SquiDBDatabaseUtils_STATEMENT_COMMIT;
  }
  else if ([prefixSql isEqual:@"ROL"]) {
    return SquiDBDatabaseUtils_STATEMENT_ABORT;
  }
  else if ([prefixSql isEqual:@"BEG"]) {
    return SquiDBDatabaseUtils_STATEMENT_BEGIN;
  }
  else if ([prefixSql isEqual:@"PRA"]) {
    return SquiDBDatabaseUtils_STATEMENT_PRAGMA;
  }
  else if ([prefixSql isEqual:@"CRE"] || [prefixSql isEqual:@"DRO"] || [prefixSql isEqual:@"ALT"]) {
    return SquiDBDatabaseUtils_STATEMENT_DDL;
  }
  else if ([prefixSql isEqual:@"ANA"] || [prefixSql isEqual:@"DET"]) {
    return SquiDBDatabaseUtils_STATEMENT_UNPREPARED;
  }
  return SquiDBDatabaseUtils_STATEMENT_OTHER;
}

jint SquiDBDatabaseUtils_getTypeOfObjectWithId_(id obj) {
  SquiDBDatabaseUtils_initialize();
  if (obj == nil) {
    return SquiDBICursor_FIELD_TYPE_NULL;
  }
  else if ([obj isKindOfClass:[IOSByteArray class]]) {
    return SquiDBICursor_FIELD_TYPE_BLOB;
  }
  else if ([obj isKindOfClass:[JavaLangFloat class]] || [obj isKindOfClass:[JavaLangDouble class]]) {
    return SquiDBICursor_FIELD_TYPE_FLOAT;
  }
  else if ([obj isKindOfClass:[JavaLangLong class]] || [obj isKindOfClass:[JavaLangInteger class]] || [obj isKindOfClass:[JavaLangShort class]] || [obj isKindOfClass:[JavaLangByte class]]) {
    return SquiDBICursor_FIELD_TYPE_INTEGER;
  }
  else {
    return SquiDBICursor_FIELD_TYPE_STRING;
  }
}

jint SquiDBDatabaseUtils_findRowIdColumnIndexWithNSStringArray_(IOSObjectArray *columnNames) {
  SquiDBDatabaseUtils_initialize();
  jint length = ((IOSObjectArray *) nil_chk(columnNames))->size_;
  for (jint i = 0; i < length; i++) {
    if ([((NSString *) nil_chk(IOSObjectArray_Get(columnNames, i))) isEqual:@"_id"]) {
      return i;
    }
  }
  return -1;
}

jint SquiDBDatabaseUtils_cursorPickFillWindowStartPositionWithInt_withInt_(jint cursorPosition, jint cursorWindowCapacity) {
  SquiDBDatabaseUtils_initialize();
  return JavaLangMath_maxWithInt_withInt_(cursorPosition - JreIntDiv(cursorWindowCapacity, 3), 0);
}

void SquiDBDatabaseUtils_appendEscapedSQLStringWithJavaLangStringBuilder_withNSString_(JavaLangStringBuilder *sb, NSString *sqlString) {
  SquiDBDatabaseUtils_initialize();
  (void) [((JavaLangStringBuilder *) nil_chk(sb)) appendWithChar:'\''];
  if ([((NSString *) nil_chk(sqlString)) java_indexOf:'\''] != -1) {
    jint length = [sqlString java_length];
    for (jint i = 0; i < length; i++) {
      jchar c = [sqlString charAtWithInt:i];
      if (c == '\'') {
        (void) [sb appendWithChar:'\''];
      }
      (void) [sb appendWithChar:c];
    }
  }
  else {
    (void) [sb appendWithNSString:sqlString];
  }
  (void) [sb appendWithChar:'\''];
}

jlong SquiDBDatabaseUtils_longForQueryWithSquiDBSQLiteDatabase_withNSString_withNSStringArray_(SquiDBSQLiteDatabase *db, NSString *query, IOSObjectArray *selectionArgs) {
  SquiDBDatabaseUtils_initialize();
  SquiDBSQLiteStatement *prog = [((SquiDBSQLiteDatabase *) nil_chk(db)) compileStatementWithNSString:query];
  @try {
    return SquiDBDatabaseUtils_longForQueryWithSquiDBSQLiteStatement_withNSStringArray_(prog, selectionArgs);
  }
  @finally {
    [((SquiDBSQLiteStatement *) nil_chk(prog)) close];
  }
}

jlong SquiDBDatabaseUtils_longForQueryWithSquiDBSQLiteStatement_withNSStringArray_(SquiDBSQLiteStatement *prog, IOSObjectArray *selectionArgs) {
  SquiDBDatabaseUtils_initialize();
  [((SquiDBSQLiteStatement *) nil_chk(prog)) bindAllArgsAsStringsWithNSStringArray:selectionArgs];
  return [prog simpleQueryForLong];
}

void SquiDBDatabaseUtils_cursorFillWindowWithSquiDBICursor_withInt_withSquiDBCursorWindow_(id<SquiDBICursor> cursor, jint position, SquiDBCursorWindow *window) {
  SquiDBDatabaseUtils_initialize();
  if (position < 0 || position >= [((id<SquiDBICursor>) nil_chk(cursor)) getCount]) {
    return;
  }
  jint oldPos = [((id<SquiDBICursor>) nil_chk(cursor)) getPosition];
  jint numColumns = [cursor getColumnCount];
  [((SquiDBCursorWindow *) nil_chk(window)) clear];
  [window setStartPositionWithInt:position];
  [window setNumColumnsWithInt:numColumns];
  if ([cursor moveToPositionWithInt:position]) {
    do {
      if (![window allocRow]) {
        break;
      }
      for (jint i = 0; i < numColumns; i++) {
        jint type = [cursor getTypeWithInt:i];
        jboolean success;
        switch (type) {
          case SquiDBICursor_FIELD_TYPE_NULL:
          success = [window putNullWithInt:position withInt:i];
          break;
          case SquiDBICursor_FIELD_TYPE_INTEGER:
          success = [window putLongWithLong:[cursor getLongWithInt:i] withInt:position withInt:i];
          break;
          case SquiDBICursor_FIELD_TYPE_FLOAT:
          success = [window putDoubleWithDouble:[cursor getDoubleWithInt:i] withInt:position withInt:i];
          break;
          case SquiDBICursor_FIELD_TYPE_BLOB:
          {
            IOSByteArray *value = [cursor getBlobWithInt:i];
            success = value != nil ? [window putBlobWithByteArray:value withInt:position withInt:i] : [window putNullWithInt:position withInt:i];
            break;
          }
          default:
          case SquiDBICursor_FIELD_TYPE_STRING:
          {
            NSString *value = [cursor getStringWithInt:i];
            success = value != nil ? [window putStringWithNSString:value withInt:position withInt:i] : [window putNullWithInt:position withInt:i];
            break;
          }
        }
        if (!success) {
          [window freeLastRow];
          break;
        }
      }
      position += 1;
    }
    while ([cursor moveToNext]);
  }
  [cursor moveToPositionWithInt:oldPos];
}

void SquiDBDatabaseUtils_bindObjectToProgramWithSquiDBSQLiteProgram_withInt_withId_(SquiDBSQLiteProgram *prog, jint index, id value) {
  SquiDBDatabaseUtils_initialize();
  if (value == nil) {
    [((SquiDBSQLiteProgram *) nil_chk(prog)) bindNullWithInt:index];
  }
  else if ([value isKindOfClass:[JavaLangDouble class]] || [value isKindOfClass:[JavaLangFloat class]]) {
    [((SquiDBSQLiteProgram *) nil_chk(prog)) bindDoubleWithInt:index withDouble:[((NSNumber *) cast_chk(value, [NSNumber class])) doubleValue]];
  }
  else if ([value isKindOfClass:[NSNumber class]]) {
    [((SquiDBSQLiteProgram *) nil_chk(prog)) bindLongWithInt:index withLong:[((NSNumber *) value) longLongValue]];
  }
  else if ([value isKindOfClass:[JavaLangBoolean class]]) {
    JavaLangBoolean *bool_ = (JavaLangBoolean *) value;
    if ([bool_ booleanValue]) {
      [((SquiDBSQLiteProgram *) nil_chk(prog)) bindLongWithInt:index withLong:1];
    }
    else {
      [((SquiDBSQLiteProgram *) nil_chk(prog)) bindLongWithInt:index withLong:0];
    }
  }
  else if ([value isKindOfClass:[IOSByteArray class]]) {
    [((SquiDBSQLiteProgram *) nil_chk(prog)) bindBlobWithInt:index withByteArray:(IOSByteArray *) cast_chk(value, [IOSByteArray class])];
  }
  else {
    [((SquiDBSQLiteProgram *) nil_chk(prog)) bindStringWithInt:index withNSString:[value description]];
  }
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(SquiDBDatabaseUtils)

J2OBJC_NAME_MAPPING(SquiDBDatabaseUtils, "com.yahoo.android.sqlite", "SquiDB")
