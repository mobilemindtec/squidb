//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: ./build/j2objc/java/ContentProviderQueryBuilder.java
//

#include "ContentProviderQueryBuilder.h"
#include "Criterion.h"
#include "Field.h"
#include "IOSClass.h"
#include "IOSObjectArray.h"
#include "J2ObjC_source.h"
#include "Order.h"
#include "ProjectionMap.h"
#include "Query.h"
#include "SqlTable.h"
#include "SqlUtils.h"
#include "java/lang/IllegalArgumentException.h"
#include "java/lang/IllegalStateException.h"
#include "java/util/ArrayList.h"
#include "java/util/List.h"

@interface ComYahooSquidbUtilityContentProviderQueryBuilder () {
 @public
  jboolean strictMode_;
  ComYahooSquidbUtilityProjectionMap *projectionMap_;
  ComYahooSquidbSqlSqlTable *dataSource_;
  IOSObjectArray *defaultOrder_;
}

- (id<JavaUtilList>)computeProjectionWithNSStringArray:(IOSObjectArray *)projectionIn;

@end

J2OBJC_FIELD_SETTER(ComYahooSquidbUtilityContentProviderQueryBuilder, projectionMap_, ComYahooSquidbUtilityProjectionMap *)
J2OBJC_FIELD_SETTER(ComYahooSquidbUtilityContentProviderQueryBuilder, dataSource_, ComYahooSquidbSqlSqlTable *)
J2OBJC_FIELD_SETTER(ComYahooSquidbUtilityContentProviderQueryBuilder, defaultOrder_, IOSObjectArray *)

__attribute__((unused)) static id<JavaUtilList> ComYahooSquidbUtilityContentProviderQueryBuilder_computeProjectionWithNSStringArray_(ComYahooSquidbUtilityContentProviderQueryBuilder *self, IOSObjectArray *projectionIn);

@implementation ComYahooSquidbUtilityContentProviderQueryBuilder

J2OBJC_IGNORE_DESIGNATED_BEGIN
- (instancetype)init {
  ComYahooSquidbUtilityContentProviderQueryBuilder_init(self);
  return self;
}
J2OBJC_IGNORE_DESIGNATED_END

- (instancetype)initWithComYahooSquidbSqlPropertyArray:(IOSObjectArray *)properties
                         withComYahooSquidbSqlSqlTable:(ComYahooSquidbSqlSqlTable *)dataSource {
  ComYahooSquidbUtilityContentProviderQueryBuilder_initWithComYahooSquidbSqlPropertyArray_withComYahooSquidbSqlSqlTable_(self, properties, dataSource);
  return self;
}

- (ComYahooSquidbUtilityContentProviderQueryBuilder *)setStrictWithBoolean:(jboolean)strict {
  self->strictMode_ = strict;
  return self;
}

- (ComYahooSquidbUtilityContentProviderQueryBuilder *)setProjectionMapWithComYahooSquidbUtilityProjectionMap:(ComYahooSquidbUtilityProjectionMap *)projectionMap {
  self->projectionMap_ = projectionMap;
  return self;
}

- (ComYahooSquidbUtilityContentProviderQueryBuilder *)setDataSourceWithComYahooSquidbSqlSqlTable:(ComYahooSquidbSqlSqlTable *)dataSource {
  self->dataSource_ = dataSource;
  return self;
}

- (ComYahooSquidbUtilityContentProviderQueryBuilder *)setDefaultOrderWithComYahooSquidbSqlOrderArray:(IOSObjectArray *)orders {
  if (orders == nil || orders->size_ == 0) {
    defaultOrder_ = nil;
  }
  else {
    defaultOrder_ = orders;
  }
  return self;
}

- (ComYahooSquidbSqlQuery *)buildWithNSStringArray:(IOSObjectArray *)projection
                                      withNSString:(NSString *)selection
                                 withNSStringArray:(IOSObjectArray *)selectionArgs
                                      withNSString:(NSString *)sortOrder {
  ComYahooSquidbSqlQuery *query = [((ComYahooSquidbSqlQuery *) nil_chk(ComYahooSquidbSqlQuery_selectWithJavaUtilList_(ComYahooSquidbUtilityContentProviderQueryBuilder_computeProjectionWithNSStringArray_(self, projection)))) fromWithComYahooSquidbSqlSqlTable:dataSource_];
  jboolean hasUserSelection = !ComYahooSquidbSqlSqlUtils_isEmptyWithNSString_(selection);
  if (hasUserSelection) {
    (void) [((ComYahooSquidbSqlQuery *) nil_chk(query)) whereWithComYahooSquidbSqlCriterion:ComYahooSquidbSqlCriterion_fromRawSelectionWithNSString_withNSStringArray_(selection, selectionArgs)];
  }
  if (!ComYahooSquidbSqlSqlUtils_isEmptyWithNSString_(sortOrder)) {
    (void) [((ComYahooSquidbSqlQuery *) nil_chk(query)) orderByWithComYahooSquidbSqlOrderArray:[IOSObjectArray newArrayWithObjects:(id[]){ ComYahooSquidbSqlOrder_fromExpressionWithNSString_(sortOrder) } count:1 type:ComYahooSquidbSqlOrder_class_()]];
  }
  else if (defaultOrder_ != nil && defaultOrder_->size_ > 0) {
    (void) [((ComYahooSquidbSqlQuery *) nil_chk(query)) orderByWithComYahooSquidbSqlOrderArray:defaultOrder_];
  }
  if (strictMode_ && hasUserSelection) {
    [((ComYahooSquidbSqlQuery *) nil_chk(query)) requestValidation];
  }
  return query;
}

- (id<JavaUtilList>)computeProjectionWithNSStringArray:(IOSObjectArray *)projectionIn {
  return ComYahooSquidbUtilityContentProviderQueryBuilder_computeProjectionWithNSStringArray_(self, projectionIn);
}

+ (const J2ObjcClassInfo *)__metadata {
  static J2ObjcMethodInfo methods[] = {
    { NULL, NULL, 0x1, -1, -1, -1, -1, -1, -1 },
    { NULL, NULL, 0x1, -1, 0, -1, 1, -1, -1 },
    { NULL, "LComYahooSquidbUtilityContentProviderQueryBuilder;", 0x1, 2, 3, -1, -1, -1, -1 },
    { NULL, "LComYahooSquidbUtilityContentProviderQueryBuilder;", 0x1, 4, 5, -1, -1, -1, -1 },
    { NULL, "LComYahooSquidbUtilityContentProviderQueryBuilder;", 0x1, 6, 7, -1, 8, -1, -1 },
    { NULL, "LComYahooSquidbUtilityContentProviderQueryBuilder;", 0x81, 9, 10, -1, -1, -1, -1 },
    { NULL, "LComYahooSquidbSqlQuery;", 0x1, 11, 12, -1, -1, -1, -1 },
    { NULL, "LJavaUtilList;", 0x2, 13, 14, -1, 15, -1, -1 },
  };
  #pragma clang diagnostic push
  #pragma clang diagnostic ignored "-Wobjc-multiple-method-names"
  #pragma clang diagnostic ignored "-Wundeclared-selector"
  methods[0].selector = @selector(init);
  methods[1].selector = @selector(initWithComYahooSquidbSqlPropertyArray:withComYahooSquidbSqlSqlTable:);
  methods[2].selector = @selector(setStrictWithBoolean:);
  methods[3].selector = @selector(setProjectionMapWithComYahooSquidbUtilityProjectionMap:);
  methods[4].selector = @selector(setDataSourceWithComYahooSquidbSqlSqlTable:);
  methods[5].selector = @selector(setDefaultOrderWithComYahooSquidbSqlOrderArray:);
  methods[6].selector = @selector(buildWithNSStringArray:withNSString:withNSStringArray:withNSString:);
  methods[7].selector = @selector(computeProjectionWithNSStringArray:);
  #pragma clang diagnostic pop
  static const J2ObjcFieldInfo fields[] = {
    { "strictMode_", "Z", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
    { "projectionMap_", "LComYahooSquidbUtilityProjectionMap;", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
    { "dataSource_", "LComYahooSquidbSqlSqlTable;", .constantValue.asLong = 0, 0x2, -1, -1, 16, -1 },
    { "defaultOrder_", "[LComYahooSquidbSqlOrder;", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
  };
  static const void *ptrTable[] = { "[LComYahooSquidbSqlProperty;LComYahooSquidbSqlSqlTable;", "([Lcom/yahoo/squidb/sql/Property<*>;Lcom/yahoo/squidb/sql/SqlTable<*>;)V", "setStrict", "Z", "setProjectionMap", "LComYahooSquidbUtilityProjectionMap;", "setDataSource", "LComYahooSquidbSqlSqlTable;", "(Lcom/yahoo/squidb/sql/SqlTable<*>;)Lcom/yahoo/squidb/utility/ContentProviderQueryBuilder;", "setDefaultOrder", "[LComYahooSquidbSqlOrder;", "build", "[LNSString;LNSString;[LNSString;LNSString;", "computeProjection", "[LNSString;", "([Ljava/lang/String;)Ljava/util/List<Lcom/yahoo/squidb/sql/Field<*>;>;", "Lcom/yahoo/squidb/sql/SqlTable<*>;" };
  static const J2ObjcClassInfo _ComYahooSquidbUtilityContentProviderQueryBuilder = { "ContentProviderQueryBuilder", "com.yahoo.squidb.utility", ptrTable, methods, fields, 7, 0x1, 8, 4, -1, -1, -1, -1, -1 };
  return &_ComYahooSquidbUtilityContentProviderQueryBuilder;
}

@end

void ComYahooSquidbUtilityContentProviderQueryBuilder_init(ComYahooSquidbUtilityContentProviderQueryBuilder *self) {
  NSObject_init(self);
  self->strictMode_ = false;
  self->projectionMap_ = nil;
  self->dataSource_ = nil;
  self->defaultOrder_ = nil;
}

ComYahooSquidbUtilityContentProviderQueryBuilder *new_ComYahooSquidbUtilityContentProviderQueryBuilder_init() {
  J2OBJC_NEW_IMPL(ComYahooSquidbUtilityContentProviderQueryBuilder, init)
}

ComYahooSquidbUtilityContentProviderQueryBuilder *create_ComYahooSquidbUtilityContentProviderQueryBuilder_init() {
  J2OBJC_CREATE_IMPL(ComYahooSquidbUtilityContentProviderQueryBuilder, init)
}

void ComYahooSquidbUtilityContentProviderQueryBuilder_initWithComYahooSquidbSqlPropertyArray_withComYahooSquidbSqlSqlTable_(ComYahooSquidbUtilityContentProviderQueryBuilder *self, IOSObjectArray *properties, ComYahooSquidbSqlSqlTable *dataSource) {
  NSObject_init(self);
  self->strictMode_ = false;
  self->projectionMap_ = nil;
  self->dataSource_ = nil;
  self->defaultOrder_ = nil;
  ComYahooSquidbUtilityProjectionMap *projectionMap = new_ComYahooSquidbUtilityProjectionMap_init();
  [projectionMap putAllWithComYahooSquidbSqlFieldArray:properties];
  (void) [self setProjectionMapWithComYahooSquidbUtilityProjectionMap:projectionMap];
  (void) [self setDataSourceWithComYahooSquidbSqlSqlTable:dataSource];
}

ComYahooSquidbUtilityContentProviderQueryBuilder *new_ComYahooSquidbUtilityContentProviderQueryBuilder_initWithComYahooSquidbSqlPropertyArray_withComYahooSquidbSqlSqlTable_(IOSObjectArray *properties, ComYahooSquidbSqlSqlTable *dataSource) {
  J2OBJC_NEW_IMPL(ComYahooSquidbUtilityContentProviderQueryBuilder, initWithComYahooSquidbSqlPropertyArray_withComYahooSquidbSqlSqlTable_, properties, dataSource)
}

ComYahooSquidbUtilityContentProviderQueryBuilder *create_ComYahooSquidbUtilityContentProviderQueryBuilder_initWithComYahooSquidbSqlPropertyArray_withComYahooSquidbSqlSqlTable_(IOSObjectArray *properties, ComYahooSquidbSqlSqlTable *dataSource) {
  J2OBJC_CREATE_IMPL(ComYahooSquidbUtilityContentProviderQueryBuilder, initWithComYahooSquidbSqlPropertyArray_withComYahooSquidbSqlSqlTable_, properties, dataSource)
}

id<JavaUtilList> ComYahooSquidbUtilityContentProviderQueryBuilder_computeProjectionWithNSStringArray_(ComYahooSquidbUtilityContentProviderQueryBuilder *self, IOSObjectArray *projectionIn) {
  id<JavaUtilList> projection = nil;
  if (self->projectionMap_ == nil) {
    if (self->strictMode_) {
      @throw new_JavaLangIllegalStateException_initWithNSString_(@"Strict mode requires a projection map to be set");
    }
    if (projectionIn != nil && projectionIn->size_ > 0) {
      projection = new_JavaUtilArrayList_initWithInt_(projectionIn->size_);
      {
        IOSObjectArray *a__ = projectionIn;
        NSString * const *b__ = a__->buffer_;
        NSString * const *e__ = b__ + a__->size_;
        while (b__ < e__) {
          NSString *expression = *b__++;
          [projection addWithId:ComYahooSquidbSqlField_fieldWithNSString_(expression)];
        }
      }
    }
  }
  else {
    if (projectionIn == nil || projectionIn->size_ == 0) {
      projection = [self->projectionMap_ getDefaultProjection];
    }
    else {
      projection = new_JavaUtilArrayList_initWithInt_(projectionIn->size_);
      {
        IOSObjectArray *a__ = projectionIn;
        NSString * const *b__ = a__->buffer_;
        NSString * const *e__ = b__ + a__->size_;
        while (b__ < e__) {
          NSString *expression = *b__++;
          ComYahooSquidbSqlField *column = [((ComYahooSquidbUtilityProjectionMap *) nil_chk(self->projectionMap_)) getWithNSString:expression];
          if (column != nil) {
            [projection addWithId:column];
          }
          else if (self->strictMode_) {
            @throw new_JavaLangIllegalArgumentException_initWithNSString_(JreStrcat("$$", @"Invalid column: ", expression));
          }
        }
      }
    }
  }
  return projection;
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(ComYahooSquidbUtilityContentProviderQueryBuilder)
